{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Booking Calendar</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Favicon -->
    <link href="{% static 'admin_static/img/favicon.ico' %}" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="{% static 'admin_static/lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
    <link href="{% static 'admin_static/lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css' %}" rel="stylesheet"/>

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'admin_static/scss/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="{% static 'admin_static/css/style.css' %}" rel="stylesheet">
    <style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;
    }
    
    .calendar {
        max-width: 900px;
        margin: auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }
    
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        background: #009CFF;
        color: white;
    }
    
    .header button {
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 1.2em;
    }
    
    .header button:hover {
        text-decoration: underline;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    th {
        background-color: #007BFF;
        color: white;
        padding: 10px;
    }
    
    td {
        width: 14.28%; /* 100% / 7 days */
        height: 100px; /* Set a fixed height for the cells */
        border: 1px solid #ddd;
        text-align: center;
        vertical-align: top; /* Align text to the top */
        position: relative; /* Position for event details */
    }
    
    td div {
        background-color: #e0f7fa; /* Light background for event details */
        border: 1px solid #007BFF;
        border-radius: 5px;
        padding: 5px;
        margin-top: 5px;
        font-size: 0.9em; /* Smaller font for event details */
    }
    
    td:hover {
        background-color: #f1f1f1; /* Slight highlight on hover */
    }
    
    .fc-day.fc-day-today {
        background-color: #e0f7fa;
    }
    /* Modal Background */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.5); /* Black with opacity */
}

/* Modal Content */
.modal-content {
    background-color: #fff;
    margin: 15% auto; /* Centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 600px; /* Maximum width */
    border-radius: 8px; /* Rounded corners */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

/* Close Button */
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

/* Transition Effects */
.modal.show {
    display: block;
}

  </style>
    
</head>


<body>
    <div class="container-xxl position-relative bg-white d-flex p-0">
        <!-- Spinner Start -->
        {% comment %} {% comment %} <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div> {% endcomment %}
        <!-- Spinner End -->

       
        <!-- Sidebar Start -->
        <div class="sidebar pe-4 pb-3">
            <nav class="navbar bg-light navbar-light">
                <a href="index.html" class="navbar-brand mx-4 mb-3">
                    <h3 class="text-primary"><i class="fa fa-hashtag me-2"></i>ADMIN</h3>
                </a>
                <div class="d-flex align-items-center ms-4 mb-4">
                    <div class="position-relative">
                        <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                        <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1"></div>
                    </div>
                    <div class="ms-3">
                        <h6 class="mb-0">Jhon Doe</h6>
                        <span>Admin</span>
                    </div>
                </div>
                <div class="navbar-nav w-100">
                    <a href="index" class="nav-item nav-link active"><i class="bi bi-house-fill"></i></i>Home</a>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-square"></i>Hall</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="hall" class="dropdown-item">Add Hall</a>
                            <a href="viewhall" class="dropdown-item">View Hall</a>
                            {% comment %} <a href="element.html" class="dropdown-item">Other Elements</a> {% endcomment %}
                        </div>
                    </div>

                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-square-half"></i>Hall Facilities</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="feature" class="dropdown-item">Manage facilities</a>
                        </div>
                    </div>

                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-nut-fill"></i>Hall Inoperability</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="inoperability" class="dropdown-item">Manage Inoperability</a>
                        </div>
                    </div>
                    <a href="booked" class="nav-item nav-link"><i class="bi bi-journal-text"></i></i>Booking List</a>
                    {% comment %} <a href="calendarview" class="nav-item nav-link"><i class="bi bi-calendar-event-fill"></i>Calender View</a> {% endcomment %}
                    <a href="#" class="nav-item nav-link"><i class="bi bi-journal-arrow-up"></i>Upcoming Event</a>
                    <a href="#" class="nav-item nav-link"><i class="bi bi-hourglass-split"></i>Booking History</a>
                  
                   
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-journals"></i>Reports</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="button.html" class="dropdown-item">Booking Report</a>
                            <a href="typography.html" class="dropdown-item">Inoperability Report</a>
                            <a href="element.html" class="dropdown-item">Payment Report</a>
                        </div>
                    </div>
                    <a href="payment" class="nav-item nav-link"><i class="bi bi-credit-card-2-front"></i>Payment</a>  
                    <a href="logout" class="nav-item nav-link"><i class="bi bi-box-arrow-left"></i>Logout</a>      
                  
                    {% comment %} <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="far fa-file-alt me-2"></i>Pages</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="signin.html" class="dropdown-item">Sign In</a>
                            <a href="signup.html" class="dropdown-item">Sign Up</a>
                            <a href="404.html" class="dropdown-item">404 Error</a>
                            <a href="blank.html" class="dropdown-item">Blank Page</a>
                        </div>
                    </div> {% endcomment %}
                </div>
            </nav>
        </div>
        <!-- Sidebar End -->


        <!-- Content Start -->
        <div class="content">
            <!-- Navbar Start -->
            <nav class="navbar navbar-expand bg-light navbar-light sticky-top px-4 py-0">
                <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
                    <h2 class="text-primary mb-0"><i class="fa fa-hashtag"></i></h2>
                </a>
                <a href="#" class="sidebar-toggler flex-shrink-0">
                    <i class="fa fa-bars"></i>
                </a>
                <form class="d-none d-md-flex ms-4">
                    <input class="form-control border-0" type="search" placeholder="Search">
                </form>
                <div class="navbar-nav align-items-center ms-auto">
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="fa fa-envelope me-lg-2"></i>
                            <span class="d-none d-lg-inline-flex">Message</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item text-center">See all message</a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="fa fa-bell me-lg-2"></i>
                            <span class="d-none d-lg-inline-flex">Notificatin</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">Profile updated</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">New user added</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">Password changed</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item text-center">See all notifications</a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <img class="rounded-circle me-lg-2" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                            <span class="d-none d-lg-inline-flex">John Doe</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">My Profile</a>
                            <a href="#" class="dropdown-item">Settings</a>
                            <a href="#" class="dropdown-item">Log Out</a>
                        </div>
                    </div>
                </div>
            </nav>
            <!-- Navbar End -->
            <div id="eventModal" class="modal">
                <div class="modal-content">
                    <span id="closeModal" class="close">&times;</span>
                    <h2 id="modalTitle"></h2>
                    <p id="modalDescription"></p>
                    <p id="modalTimeslot"></p>
                    <p id="modalId"></p> <!-- New line for Booking ID -->
                </div>
            </div>
            
            
            <div class="container">
                <h2 id="monthYear"></h2>
                <button id="prev" class="btn btn-secondary">Previous</button>
                <button id="next" class="btn btn-secondary">Next</button>
                
                <table id="calendar">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody id="calendarBody"></tbody>
                </table>
                
                <input type="hidden" id="hallId" value="{{ hall_view.id }}">
            
                <!-- Modal for Booking Details -->
                <div id="bookingModal" class="modal">
                    <div class="modal-content">
                        <span id="closeModal" style="float:right; cursor:pointer;">&times;</span>
                        <h3 id="modalTitle"></h3>
                        <div id="modalBody"></div>
                    </div>
                </div>
            </div>
            
            <script>
                const monthNames = [
                    "January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"
                ];
                
                let currentDate = new Date();
                let bookings = {};
                
                function renderCalendar() {
                    const monthYearElement = document.getElementById("monthYear");
                    const calendarBody = document.getElementById("calendarBody");
                    const year = currentDate.getFullYear();
                    const month = currentDate.getMonth();
                    
                    monthYearElement.innerText = `${monthNames[month]} ${year}`;
                    calendarBody.innerHTML = ""; 
                    
                    const firstDay = new Date(year, month, 1).getDay();
                    const daysInMonth = new Date(year, month + 1, 0).getDate();
                    
                    let row = document.createElement("tr");
                    
                    for (let i = 0; i < firstDay; i++) {
                        const cell = document.createElement("td");
                        row.appendChild(cell);
                    }
                    
                    for (let day = 1; day <= daysInMonth; day++) {
                        const cell = document.createElement("td");
                        cell.innerText = day;
                        
                        const dateString = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                        if (bookings[dateString]) {
                            cell.style.backgroundColor = 'lightcoral';
                            cell.title = "Booked";
                            
                            const eventDetails = document.createElement("div");
                            eventDetails.innerText = `${bookings[dateString].eventName} (${bookings[dateString].timeslot})`;
                            cell.appendChild(eventDetails);
                            
                            cell.style.cursor = "pointer";
                            cell.addEventListener("click", () => openModal(dateString));
                        }
                        
                        row.appendChild(cell);
                        
                        if ((day + firstDay) % 7 === 0) {
                            calendarBody.appendChild(row);
                            row = document.createElement("tr");
                        }
                    }
                    
                    if (row.children.length > 0) {
                        calendarBody.appendChild(row);
                    }
                }
                
                function updateBookings(eventData) {
                    bookings = {};
                    eventData.forEach(event => {
                        const eventDate = new Date(event.start);
                        const formattedDate = `${eventDate.getFullYear()}-${(eventDate.getMonth() + 1).toString().padStart(2, '0')}-${eventDate.getDate().toString().padStart(2, '0')}`;
                        bookings[formattedDate] = {
                            eventName: event.title,
                            timeslot: event.timeslot,
                            name: event.name,
                            address: event.address,
                            contact: event.contact,
                            ac: event.ac,
                            description: event.description,
                            hallname: event.hallname,
                        };
                    });
                }
    
                function openModal(dateString) {
                    const modal = document.getElementById("bookingModal");
                    const modalTitle = document.getElementById("modalTitle");
                    const modalBody = document.getElementById("modalBody");
                    
                    if (bookings[dateString]) {
                        modalTitle.innerText = `Details for ${dateString}`;
                        modalBody.innerHTML = `
                            <p><strong>Event:</strong> ${bookings[dateString].eventName}</p>
                            <p><strong>Timeslot:</strong> ${bookings[dateString].timeslot}</p>
                            <p><strong>User Name:</strong> ${bookings[dateString].name}</p>
                            <p><strong>Address:</strong> ${bookings[dateString].address}</p>
                            <p><strong>Contact:</strong> ${bookings[dateString].contact}</p>
                            <p><strong>AC:</strong> ${bookings[dateString].ac}</p>
                            <p><strong>Description:</strong> ${bookings[dateString].description}</p>
                            <p><strong>Hall Name:</strong> ${bookings[dateString].hallname}</p>
                        `;
                    } else {
                        modalTitle.innerText = `No bookings for ${dateString}`;
                        modalBody.innerHTML = '<p>No details available for this date.</p>';
                    }
                    
                    modal.classList.add("show");
                }
                
                document.addEventListener('DOMContentLoaded', () => {
                    const hallId = document.getElementById("hallId").value;
                    checkAvailability(hallId);
            
                    document.getElementById("prev").addEventListener("click", () => {
                        currentDate.setMonth(currentDate.getMonth() - 1);
                        renderCalendar();
                    });
                    
                    document.getElementById("next").addEventListener("click", () => {
                        currentDate.setMonth(currentDate.getMonth() + 1);
                        renderCalendar();
                    });
            
                    // Close modal event
                    document.getElementById("closeModal").addEventListener("click", () => {
                        const modal = document.getElementById("bookingModal");
                        modal.classList.remove("show");
                    });
            
                    // Close modal when clicking outside of it
                    window.addEventListener("click", (event) => {
                        const modal = document.getElementById("bookingModal");
                        if (event.target === modal) {
                            modal.classList.remove("show");
                        }
                    });
                });
            </script>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Assuming bookings are stored in localStorage
                    const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
                    
                    // Initialize your calendar here (using FullCalendar as an example)
                    $('#calendar').fullCalendar({
                        header: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'month,agendaWeek,agendaDay'
                        },
                        events: bookings.map(event => ({
                            eventName: event.title,
                            timeslot: event.timeslot,
                            name: event.name,
                            address: event.address,
                            contact: event.contact,
                            ac: event.ac,
                            description: event.description,
                            hallname: event.hallname,
                        })),
                        editable: true,
                        eventLimit: true // allow "more" link when too many events
                    });
                });
            </script>

            
            <!-- Footer Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="bg-light rounded-top p-4">
                    <div class="row">
                        <div class="col-12 col-sm-6 text-center text-sm-start">
                            &copy; <a href="#">Your Site Name</a>, All Right Reserved. 
                        </div>
                        <div class="col-12 col-sm-6 text-center text-sm-end">
                            <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
                            Designed By <a href="https://htmlcodex.com">HTML Codex</a>
                        </br>
                        Distributed By <a class="border-bottom" href="https://themewagon.com" target="_blank">ThemeWagon</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Footer End -->
        </div>
        <!-- Content End -->


        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <!-- JavaScript Libraries -->
    <script src="{% static 'admin_static/js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'admin_static/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/chart/chart.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/easing/easing.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/waypoints/waypoints.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/owlcarousel/owl.carousel.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/moment.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/moment-timezone.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js' %}"></script>

    <!-- Template Javascript -->
{% comment %} <script src="{% static 'admin_static/js/main.js' %}"></script>  {% endcomment %}
</body>

</html>









AC_CHOICES = [
    ('Yes', 'Yes'),
    ('No', 'No'),
]

APPROVAL_STATUS_CHOICES = [
    ('Pending', 'Pending'),
    ('Approved', 'Approved'),
    ('Rejected', 'Rejected'),
]

ac = models.CharField(max_length=3, choices=AC_CHOICES)
approval_status = models.CharField(max_length=10, choices=APPROVAL_STATUS_CHOICES)












{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Booking Calendar</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Favicon -->
    <link href="{% static 'admin_static/img/favicon.ico' %}" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="{% static 'admin_static/lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
    <link href="{% static 'admin_static/lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css' %}" rel="stylesheet"/>

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'admin_static/scss/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="{% static 'admin_static/css/style.css' %}" rel="stylesheet">
    <style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;
    }
    
    .calendar {
        max-width: 900px;
        margin: auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }
    
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        background: #009CFF;
        color: white;
    }
    
    .header button {
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 1.2em;
    }
    
    .header button:hover {
        text-decoration: underline;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    th {
        background-color: #007BFF;
        color: white;
        padding: 10px;
    }
    
    td {
        width: 14.28%; /* 100% / 7 days */
        height: 100px; /* Set a fixed height for the cells */
        border: 1px solid #ddd;
        text-align: center;
        vertical-align: top; /* Align text to the top */
        position: relative; /* Position for event details */
    }
    
    td div {
        background-color: #e0f7fa; /* Light background for event details */
        border: 1px solid #007BFF;
        border-radius: 5px;
        padding: 5px;
        margin-top: 5px;
        font-size: 0.9em; /* Smaller font for event details */
    }
    
    td:hover {
        background-color: #f1f1f1; /* Slight highlight on hover */
    }
    
    .fc-day.fc-day-today {
        background-color: #e0f7fa;
    }
    /* Modal Background */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.5); /* Black with opacity */
}

/* Modal Content */
.modal-content {
    background-color: #fff;
    margin: 15% auto; /* Centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 600px; /* Maximum width */
    border-radius: 8px; /* Rounded corners */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

/* Close Button */
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

/* Transition Effects */
.modal.show {
    display: block;
}

  </style>
    
</head>


<body>
    <div class="container-xxl position-relative bg-white d-flex p-0">
        <!-- Spinner Start -->
        {% comment %} {% comment %} <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div> {% endcomment %}
        <!-- Spinner End -->

       
        <!-- Sidebar Start -->
        <div class="sidebar pe-4 pb-3">
            <nav class="navbar bg-light navbar-light">
                <a href="index.html" class="navbar-brand mx-4 mb-3">
                    <h3 class="text-primary"><i class="fa fa-hashtag me-2"></i>ADMIN</h3>
                </a>
                <div class="d-flex align-items-center ms-4 mb-4">
                    <div class="position-relative">
                        <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                        <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1"></div>
                    </div>
                    <div class="ms-3">
                        <h6 class="mb-0">Jhon Doe</h6>
                        <span>Admin</span>
                    </div>
                </div>
                <div class="navbar-nav w-100">
                    <a href="index" class="nav-item nav-link active"><i class="bi bi-house-fill"></i></i>Home</a>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-square"></i>Hall</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="hall" class="dropdown-item">Add Hall</a>
                            <a href="viewhall" class="dropdown-item">View Hall</a>
                            {% comment %} <a href="element.html" class="dropdown-item">Other Elements</a> {% endcomment %}
                        </div>
                    </div>

                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-square-half"></i>Hall Facilities</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="feature" class="dropdown-item">Manage facilities</a>
                        </div>
                    </div>

                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-nut-fill"></i>Hall Inoperability</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="inoperability" class="dropdown-item">Manage Inoperability</a>
                        </div>
                    </div>
                    <a href="booked" class="nav-item nav-link"><i class="bi bi-journal-text"></i></i>Booking List</a>
                    {% comment %} <a href="calendarview" class="nav-item nav-link"><i class="bi bi-calendar-event-fill"></i>Calender View</a> {% endcomment %}
                    <a href="#" class="nav-item nav-link"><i class="bi bi-journal-arrow-up"></i>Upcoming Event</a>
                    <a href="#" class="nav-item nav-link"><i class="bi bi-hourglass-split"></i>Booking History</a>
                  
                   
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-journals"></i>Reports</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="button.html" class="dropdown-item">Booking Report</a>
                            <a href="typography.html" class="dropdown-item">Inoperability Report</a>
                            <a href="element.html" class="dropdown-item">Payment Report</a>
                        </div>
                    </div>
                    <a href="payment" class="nav-item nav-link"><i class="bi bi-credit-card-2-front"></i>Payment</a>  
                    <a href="logout" class="nav-item nav-link"><i class="bi bi-box-arrow-left"></i>Logout</a>      
                  
                    {% comment %} <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"><i class="far fa-file-alt me-2"></i>Pages</a>
                        <div class="dropdown-menu bg-transparent border-0">
                            <a href="signin.html" class="dropdown-item">Sign In</a>
                            <a href="signup.html" class="dropdown-item">Sign Up</a>
                            <a href="404.html" class="dropdown-item">404 Error</a>
                            <a href="blank.html" class="dropdown-item">Blank Page</a>
                        </div>
                    </div> {% endcomment %}
                </div>
            </nav>
        </div>
        <!-- Sidebar End -->


        <!-- Content Start -->
        <div class="content">
            <!-- Navbar Start -->
            <nav class="navbar navbar-expand bg-light navbar-light sticky-top px-4 py-0">
                <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
                    <h2 class="text-primary mb-0"><i class="fa fa-hashtag"></i></h2>
                </a>
                <a href="#" class="sidebar-toggler flex-shrink-0">
                    <i class="fa fa-bars"></i>
                </a>
                <form class="d-none d-md-flex ms-4">
                    <input class="form-control border-0" type="search" placeholder="Search">
                </form>
                <div class="navbar-nav align-items-center ms-auto">
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="fa fa-envelope me-lg-2"></i>
                            <span class="d-none d-lg-inline-flex">Message</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <div class="d-flex align-items-center">
                                    <img class="rounded-circle" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                                    <div class="ms-2">
                                        <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                        <small>15 minutes ago</small>
                                    </div>
                                </div>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item text-center">See all message</a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="fa fa-bell me-lg-2"></i>
                            <span class="d-none d-lg-inline-flex">Notificatin</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">Profile updated</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">New user added</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item">
                                <h6 class="fw-normal mb-0">Password changed</h6>
                                <small>15 minutes ago</small>
                            </a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-item text-center">See all notifications</a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <img class="rounded-circle me-lg-2" src="{% static 'admin_static/img/user.jpg' %}" alt="" style="width: 40px; height: 40px;">
                            <span class="d-none d-lg-inline-flex">John Doe</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">My Profile</a>
                            <a href="#" class="dropdown-item">Settings</a>
                            <a href="#" class="dropdown-item">Log Out</a>
                        </div>
                    </div>
                </div>
            </nav>
         <!-- Navbar End -->
<!-- Navbar End -->
<div id="eventModal" class="modal">
    <div class="modal-content">
        <span id="closeModal" class="close">&times;</span>
        <h2 id="modalTitle"></h2>
        <p id="modalDescription"></p>
        <p id="modalTimeslot"></p>
        <p id="modalId"></p> <!-- New line for Booking ID -->
    </div>
</div>

<div class="container">
    <h2 id="monthYear"></h2>
    <button id="prev" class="btn btn-secondary">Previous</button>
    <button id="next" class="btn btn-secondary">Next</button>

    <table id="calendar">
        <thead>
            <tr>
                <th>Sun</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
            </tr>
        </thead>
        <tbody id="calendarBody"></tbody>
    </table>

    

    <input type="hidden" id="hallId" value="{{ hall_view.id }}">
 

    <!-- Modal for Booking Details -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span id="closeModal" style="float:right; cursor:pointer;">&times;</span>
            <h3 id="modalTitle"></h3>
            <div id="modalBody"></div>
        </div>
    </div>
</div>

<script>

    const monthNames = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
    ];

    let currentDate = new Date();
    let bookings = {};
    
    function renderCalendar() {
        const monthYearElement = document.getElementById("monthYear");
        const calendarBody = document.getElementById("calendarBody");
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        monthYearElement.innerText = `${monthNames[month]} ${year}`;
        calendarBody.innerHTML = "";

        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        let row = document.createElement("tr");

        for (let i = 0; i < firstDay; i++) {
            const cell = document.createElement("td");
            row.appendChild(cell);
        }

        for (let day = 1; day <= daysInMonth; day++) {
            const cell = document.createElement("td");
            cell.innerText = day;

            const dateString = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
            if (bookings[dateString]) {
                cell.style.backgroundColor = 'lightcoral';
                cell.title = "Booked";

                const eventDetails = document.createElement("div");
                eventDetails.innerText = `${bookings[dateString].eventName} (${bookings[dateString].timeslot})`;
                cell.appendChild(eventDetails);

                cell.style.cursor = "pointer";
                cell.addEventListener("click", () => openModal(dateString));
            }

            row.appendChild(cell);

            if ((day + firstDay) % 7 === 0) {
                calendarBody.appendChild(row);
                row = document.createElement("tr");
            }
        }

        if (row.children.length > 0) {
            calendarBody.appendChild(row);
        }
    }

    function updateBookings(eventData) {
        bookings = {};
        const hallId = document.getElementById("hallId").value; // Get the hall ID

        eventData.forEach(event => {
            if (event.hallId === hallId) { // Filter events by hall ID
                const eventDate = new Date(event.start);
                const formattedDate = `${eventDate.getFullYear()}-${(eventDate.getMonth() + 1).toString().padStart(2, '0')}-${eventDate.getDate().toString().padStart(2, '0')}`;
                bookings[formattedDate] = {
                    eventName: event.title,
                    timeslot: event.timeslot,
                    name: event.name,
                    address: event.address,
                    contact: event.contact,
                    ac: event.ac,
                    description: event.description,
                    hallname: event.hallname,
                    id: event.id // Include the event ID
                };
            }
        });
        renderCalendar(); // Render calendar after updating bookings
    }

    document.addEventListener('DOMContentLoaded', () => {
        // Retrieve bookings from local storage
        const bookings = JSON.parse(localStorage.getItem('bookings')) || [];

        if (bookings.length === 0) {
            document.getElementById('calendar').innerHTML = '<p>No bookings available.</p>';
            return;
        }

        // Function to render bookings on the calendar
        const renderCalendar = (bookings) => {
            const calendarDiv = document.getElementById('calendar');
            
            // Assuming you have a calendar library or custom code to display events
            bookings.forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.innerHTML = `
                    <strong>${event.title}</strong><br>
                    Date: ${event.date}<br>
                    Time: ${event.start_time} - ${event.end_time}<br>
                `;
                calendarDiv.appendChild(eventElement);
            });
        };

        renderCalendar(bookings);
    });


    function openModal(dateString) {
        const modal = document.getElementById("bookingModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalBody = document.getElementById("modalBody");

        if (bookings[dateString]) {
            modalTitle.innerText = `Details for ${dateString}`;
            modalBody.innerHTML = `
                <p><strong>Event:</strong> ${bookings[dateString].eventName}</p>
                <p><strong>Timeslot:</strong> ${bookings[dateString].timeslot}</p>
                <p><strong>User Name:</strong> ${bookings[dateString].name}</p>
                <p><strong>Address:</strong> ${bookings[dateString].address}</p>
                <p><strong>Contact:</strong> ${bookings[dateString].contact}</p>
                <p><strong>AC:</strong> ${bookings[dateString].ac}</p>
                <p><strong>Description:</strong> ${bookings[dateString].description}</p>
                <p><strong>Hall Name:</strong> ${bookings[dateString].hallname}</p>
                <p><strong>Booking ID:</strong> ${bookings[dateString].id}</p>
            `;
        } else {
            modalTitle.innerText = `No bookings for ${dateString}`;
            modalBody.innerHTML = '<p>No details available for this date.</p>';
        }

        modal.classList.add("show");
    }

    document.addEventListener('DOMContentLoaded', () => {
        const hallId = document.getElementById("hallId").value;

        // Load bookings from local storage and update the calendar
        const savedBookings = JSON.parse(localStorage.getItem('bookings')) || [];
        updateBookings(savedBookings);

        document.getElementById("prev").addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });

        document.getElementById("next").addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // Close modal event
        document.getElementById("closeModal").addEventListener("click", () => {
            const modal = document.getElementById("bookingModal");
            modal.classList.remove("show");
        });

        // Close modal when clicking outside of it
        window.addEventListener("click", (event) => {
            const modal = document.getElementById("bookingModal");
            if (event.target === modal) {
                modal.classList.remove("show");
            }
        });
    });
</script>


 

<style>
    /* Modal styling */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }
    .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
    }
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }
    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
    .show {
        display: block; /* Show the modal */
    }
</style>


            
            <!-- Footer Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="bg-light rounded-top p-4">
                    <div class="row">
                        <div class="col-12 col-sm-6 text-center text-sm-start">
                            &copy; <a href="#">Your Site Name</a>, All Right Reserved. 
                        </div>
                        <div class="col-12 col-sm-6 text-center text-sm-end">
                            <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
                            Designed By <a href="https://htmlcodex.com">HTML Codex</a>
                        </br>
                        Distributed By <a class="border-bottom" href="https://themewagon.com" target="_blank">ThemeWagon</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Footer End -->
        </div>
        <!-- Content End -->


        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <!-- JavaScript Libraries -->
    <script src="{% static 'admin_static/js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'admin_static/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/chart/chart.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/easing/easing.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/waypoints/waypoints.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/owlcarousel/owl.carousel.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/moment.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/moment-timezone.min.js' %}"></script>
    <script src="{% static 'admin_static/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js' %}"></script>

    <!-- Template Javascript -->
{% comment %} <script src="{% static 'admin_static/js/main.js' %}"></script>  {% endcomment %}
</body>

</html>

